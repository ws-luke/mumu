import{r as p,n as E,h as g,c as n,d as y,a as s,t as _,e as C,w as a,v as i,F as k,q as w,j as $,I as W,J as q,i as B,y as D,g as F,o as d,b as R,u as z}from"./index-95Eu6UpM.js";import{_ as J}from"./ToastNotification-DHUXdT8a.js";const L={class:"container-fluid"},A={class:"row mb-4"},G={class:"col d-flex justify-content-between align-items-center"},H={class:"breadcrumb mb-0"},K={class:"breadcrumb-item"},Q={class:"breadcrumb-item active","aria-current":"page"},X={class:"row"},Y={class:"col-12 col-lg-8"},Z={class:"card mb-4"},ss={class:"card-body"},os={class:"row"},ts={class:"mb-3 col-lg-6"},ls={class:"mb-3 col-lg-6"},es={class:"mb-3 col-lg-6"},as={class:"mb-3 col-lg-6"},rs={class:"mb-3 col-lg-6"},is={class:"card mb-4"},ns={class:"card-body"},ds={class:"col-3"},us=["for"],cs=["id","onUpdate:modelValue"],ms={class:"col-3"},ps=["for"],bs=["id","onUpdate:modelValue"],vs={class:"col-3"},fs=["for"],gs=["id","onUpdate:modelValue"],ys={class:"col-3 d-flex align-items-end"},_s=["onClick"],ks={class:"card mb-4"},ws={class:"card-body"},Us={class:"row"},hs={class:"col-lg-3"},Vs=["src"],Cs={class:"row"},Rs=["for"],Ms={class:"d-flex justify-content-between"},Ss=["onUpdate:modelValue","id"],$s=["onClick"],qs=["src"],xs={class:"col-12 col-lg-4"},Ps={class:"card mb-4"},Is={class:"card-body"},js={class:"mb-3 col"},Ts=["value"],Ns={class:"mb-3 col"},Os=["disabled"],Es=["value"],Ws={class:"card mb-4"},Bs={class:"card-body"},Ds={class:"form-check form-switch mb-3"},Fs=["checked"],zs={class:"mb-3"},Js={class:"form-check form-check-inline"},Ls={class:"form-check form-check-inline"},As={class:"card mb-4"},Gs={class:"card-body"},Hs={class:"mb-3"},Ks={class:"mb-3"},Qs={class:"mb-3"},oo={__name:"ProductView",setup(Xs){const f="https://mumuapi.zeabur.app/api",M=z(),U=D().params.id||null,h=p(!!U),c=p([]),V=p([]),b=p([]),v=p(null),t=p({title:"",weight:"",material:"",warranty:"",retail_Price:"",origin_price:"",price:"",unit:"",is_enabled:"",is_stock:"",category:"",subcategory:"",imageUrl:"",imagesUrl:[""],productVariants:c}),x=async()=>{try{const{data:e}=await g.get(`${f}/categories/all`);V.value=Object.values(e.data)}catch(e){console.error("取得產品類別失敗:",e)}},S=async()=>{if(!t.value.category){b.value=[];return}const e=V.value.find(o=>o.name===t.value.category);e!=null&&e.subcategories?b.value=e.subcategories:b.value=[]},P=()=>{t.value.imagesUrl.push("")},I=e=>{t.value.imagesUrl.splice(e,1)},j=()=>{c.value.push({model:"",color:"",quantity:null})},T=e=>{c.value.splice(e,1)},N=async()=>{try{const o=(await g.post(`${f}/products/product`,t.value)).data.message||"產品新增成功！";v.value.showSuccessToast(o),t.value={},c.value=[],M.push("/admin/products")}catch(e){const o=e.message||"新增產品失敗";v.value.showErrorToast(o)}},O=async e=>{try{const m=(await g.put(`${f}/products/product/${e}`,t.value)).data.message||"產品編輯成功！";v.value.showSuccessToast(m),t.value={},c.value=[],M.push("/admin/products")}catch(o){const m=o.message||"編輯產品失敗";v.value.showErrorToast(m)}};return E(async()=>{if(await x(),h.value)try{const{data:e}=await g.get(`${f}/products/${U}`);t.value=e.data,c.value=e.data.productVariants,t.value.category&&S()}catch(e){console.error("無法載入產品資料",e)}}),(e,o)=>{const m=F("router-link");return d(),n("div",L,[y(J,{ref_key:"toast",ref:v},null,512),s("div",A,[s("div",G,[s("div",null,[s("h2",null,_(h.value?"編輯產品":"新增產品"),1),s("nav",null,[s("ol",H,[s("li",K,[y(m,{to:"/admin/dashboard"},{default:C(()=>o[15]||(o[15]=[R("首頁")])),_:1})]),s("li",Q,[y(m,{to:"/admin/products"},{default:C(()=>o[16]||(o[16]=[R("產品")])),_:1})]),o[17]||(o[17]=s("li",{class:"breadcrumb-item active","aria-current":"page"}," 新增產品 ",-1))])])]),y(m,{to:"/admin/products",class:"btn btn-primary"},{default:C(()=>o[18]||(o[18]=[R("回訂單列表")])),_:1})])]),s("div",X,[s("div",Y,[s("div",Z,[s("div",ss,[o[24]||(o[24]=s("h4",{class:"h5 mb-4"},"產品資訊",-1)),s("div",os,[s("div",ts,[o[19]||(o[19]=s("label",{class:"form-label",for:"productName"},"產品名稱",-1)),a(s("input",{class:"form-control",id:"productName","onUpdate:modelValue":o[0]||(o[0]=l=>t.value.title=l),type:"text"},null,512),[[i,t.value.title]])]),s("div",ls,[o[20]||(o[20]=s("label",{class:"form-label",for:"productWeight"},"重量",-1)),a(s("input",{class:"form-control",type:"number",id:"productWeight","onUpdate:modelValue":o[1]||(o[1]=l=>t.value.weight=l)},null,512),[[i,t.value.weight]])]),s("div",es,[o[21]||(o[21]=s("label",{class:"form-label",for:"productMaterial"},"材質",-1)),a(s("input",{class:"form-control",type:"text",id:"productMaterial","onUpdate:modelValue":o[2]||(o[2]=l=>t.value.material=l)},null,512),[[i,t.value.material]])]),s("div",as,[o[22]||(o[22]=s("label",{class:"form-label",for:"productWarranty"},"保固",-1)),a(s("input",{class:"form-control",type:"text",id:"productWarranty","onUpdate:modelValue":o[3]||(o[3]=l=>t.value.warranty=l)},null,512),[[i,t.value.warranty]])]),s("div",rs,[o[23]||(o[23]=s("label",{class:"form-label",for:"productUnit"},"單位",-1)),a(s("input",{class:"form-control",type:"text",id:"productUnit","onUpdate:modelValue":o[4]||(o[4]=l=>t.value.unit=l)},null,512),[[i,t.value.unit]])])])])]),s("div",is,[s("div",ns,[s("div",{class:"col-12 d-flex align-items-center justify-content-between"},[o[25]||(o[25]=s("h4",{class:"mb-0 h5"},"顏色及數量",-1)),s("button",{onClick:j,type:"button",class:"btn btn-primary"},"新增")]),(d(!0),n(k,null,w(c.value,(l,r)=>(d(),n("div",{class:"row mt-3",key:r},[s("div",ds,[s("label",{class:"form-label",for:"form-model-"+r},"型號",8,us),a(s("input",{type:"text",class:"form-control",id:"form-model-"+r,"onUpdate:modelValue":u=>l.model=u,required:""},null,8,cs),[[i,l.model]])]),s("div",ms,[s("label",{class:"form-label",for:"form-color-"+r},"顏色",8,ps),a(s("input",{type:"text",class:"form-control",id:"form-color-"+r,"onUpdate:modelValue":u=>l.color=u,required:""},null,8,bs),[[i,l.color]])]),s("div",vs,[s("label",{class:"form-label",for:"form-quantity-"+r},"數量",8,fs),a(s("input",{type:"number",class:"form-control",id:"form-quantity-"+r,"onUpdate:modelValue":u=>l.quantity=u,required:""},null,8,gs),[[i,l.quantity]])]),s("div",ys,[s("button",{onClick:u=>T(r),type:"button",class:"btn btn-outline-danger w-100"}," 刪除 ",8,_s)])]))),128))])]),s("div",ks,[s("div",ws,[o[28]||(o[28]=s("h4",{class:"h5 mb-4"},"產品圖片",-1)),s("div",Us,[s("div",hs,[o[26]||(o[26]=s("label",{class:"form-label"},"產品主圖片",-1)),a(s("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=l=>t.value.imageUrl=l)},null,512),[[i,t.value.imageUrl]]),s("img",{class:"productImg img-fluid mb-3",src:t.value.imageUrl,alt:"",width:"250"},null,8,Vs)])]),s("div",Cs,[s("div",{class:"d-flex align-items-center mb-3 justify-content-between"},[o[27]||(o[27]=s("p",{class:"mb-0 fs-5"},"產品其他圖片",-1)),s("button",{class:"btn btn-primary",onClick:P},"新增")]),(d(!0),n(k,null,w(t.value.imagesUrl,(l,r)=>(d(),n("div",{key:r,class:"col-lg-4"},[s("label",{class:"form-label",for:"form-image-"+r},"圖片"+_(r+1),9,Rs),s("div",Ms,[a(s("input",{type:"text",class:"form-control w-75","onUpdate:modelValue":u=>t.value.imagesUrl[r]=u,id:"form-image-"+r},null,8,Ss),[[i,t.value.imagesUrl[r]]]),s("button",{class:"btn btn-outline-danger",onClick:u=>I(r)},"刪除",8,$s)]),s("img",{class:"productImg img-fluid my-3 w-100",src:t.value.imagesUrl[r],alt:""},null,8,qs)]))),128))])])])]),s("div",xs,[s("div",Ps,[s("div",Is,[o[33]||(o[33]=s("h4",{class:"mb-4 h5"},"產品類別",-1)),s("div",js,[o[30]||(o[30]=s("label",{class:"form-label",for:"productCategory"},"產品類別",-1)),a(s("select",{class:"form-select",id:"productCategory","onUpdate:modelValue":o[6]||(o[6]=l=>t.value.category=l),onChange:S},[o[29]||(o[29]=s("option",{value:"",disabled:""},"請選擇產品類別",-1)),(d(!0),n(k,null,w(V.value,l=>(d(),n("option",{key:l.id,value:l.name},_(l.name),9,Ts))),128))],544),[[$,t.value.category]])]),s("div",Ns,[o[32]||(o[32]=s("label",{class:"form-label",for:"productSubcategory"},"子類別",-1)),a(s("select",{class:"form-select",id:"productSubcategory","onUpdate:modelValue":o[7]||(o[7]=l=>t.value.subcategory=l),disabled:b.value.length===0},[o[31]||(o[31]=s("option",{value:"",disabled:""},"請選擇子類別",-1)),(d(!0),n(k,null,w(b.value,l=>(d(),n("option",{key:l.id,value:l.name},_(l.name),9,Es))),128))],8,Os),[[$,t.value.subcategory]])])])]),s("div",Ws,[s("div",Bs,[s("div",Ds,[a(s("input",{id:"flexSwitchStock",class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=l=>t.value.is_stock=l),checked:t.value.is_stock},null,8,Fs),[[W,t.value.is_stock]]),o[34]||(o[34]=s("label",{for:"flexSwitchStock",class:"form-check-label"},"有庫存",-1))]),s("div",zs,[o[37]||(o[37]=s("label",{class:"form-label"},"狀態",-1)),o[38]||(o[38]=s("br",null,null,-1)),s("div",Js,[a(s("input",{id:"inlineRadio1",class:"form-check-input",type:"radio","onUpdate:modelValue":o[9]||(o[9]=l=>t.value.is_enabled=l),value:1,name:"inlineRadioOptions"},null,512),[[q,t.value.is_enabled]]),o[35]||(o[35]=s("label",{title:"",for:"inlineRadio1",class:"form-check-label"},"上架",-1))]),s("div",Ls,[a(s("input",{id:"inlineRadio2",class:"form-check-input",type:"radio","onUpdate:modelValue":o[10]||(o[10]=l=>t.value.is_enabled=l),value:0,name:"inlineRadioOptions"},null,512),[[q,t.value.is_enabled]]),o[36]||(o[36]=s("label",{title:"",for:"inlineRadio2",class:"form-check-label"},"下架",-1))])])])]),s("div",As,[s("div",Gs,[o[42]||(o[42]=s("h4",{class:"mb-4 h5"},"產品價格",-1)),s("div",Hs,[o[39]||(o[39]=s("label",{class:"form-label",for:"productRetail_price"},"終端售價",-1)),a(s("input",{class:"form-control",id:"productRetail_price",type:"number","onUpdate:modelValue":o[11]||(o[11]=l=>t.value.retail_Price=l)},null,512),[[i,t.value.retail_Price]])]),s("div",Ks,[o[40]||(o[40]=s("label",{class:"form-label",for:"productOrigin_price"},"最低終端售價",-1)),a(s("input",{class:"form-control",id:"productOrigin_price",type:"number","onUpdate:modelValue":o[12]||(o[12]=l=>t.value.origin_price=l)},null,512),[[i,t.value.origin_price]])]),s("div",Qs,[o[41]||(o[41]=s("label",{class:"form-label",for:"productPrice"},"批發價",-1)),a(s("input",{class:"form-control",id:"productPrice",type:"number","onUpdate:modelValue":o[13]||(o[13]=l=>t.value.price=l)},null,512),[[i,t.value.price]])])])]),h.value?(d(),n("button",{key:0,type:"button",class:"btn btn-success w-100",onClick:o[14]||(o[14]=l=>O(B(U)))},"編輯產品")):(d(),n("button",{key:1,type:"button",class:"btn btn-success w-100",onClick:N},"新增產品"))])])])}}};export{oo as default};
