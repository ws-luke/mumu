import{r,l as B,m as L,c as l,a,b as w,d as f,F as g,n as b,t as d,k as V,p as k,q as j,f as q,h as N,o as c,e as _}from"./index-Hf8QJDxd.js";const D={class:"container mt-4"},M={"aria-label":"breadcrumb",class:"mb-4"},F={class:"breadcrumb"},O={class:"breadcrumb-item"},z={class:"row"},E={class:"mb-6 mb-md-0 col-lg-3 col-md-4 d-none d-lg-block"},R={class:"accordion",id:"accordionProductsPage"},T=["id"],U=["data-bs-target","aria-controls"],A=["id","aria-labelledby"],G={class:"accordion-body p-0"},H={class:"navbar-nav px-3"},I={class:"col-lg-9 col-md-12"},J={class:"row justify-content-between mb-4"},K={class:"col"},Q={class:"row row-cols-2 row-cols-xl-4 row-cols-lg-3 g-3 mb-4"},W={class:"card h-100"},X=["src"],Y={class:"card-body"},Z={class:"card-title text-center"},S={"aria-label":"Page navigation example"},aa={class:"pagination justify-content-center"},ea=["onClick"],oa={__name:"ShopProductsView",setup(ta){const v=j(),o=r(""),i=r(""),x=r([]),P=void 0,$=r([]),n=r({}),h=r(0),m=async(s,t,u)=>{try{const e=await q.get(`${P}/products/all`,{params:{page:s,category:t,subcategory:u}});$.value=e.data.data.products||[],n.value=e.data.data.pagination,h.value=n.value.totalPages}catch(e){console.error("取得商品資料失敗:",e)}},C=async()=>{try{const{data:s}=await q.get(`${P}/categories/all`);x.value=Object.values(s.data)}catch(s){console.error("取得分類資料失敗:",s)}},y=async s=>{await m(s,o.value,i.value)};return B(async()=>{var s,t;o.value=((s=v.query.category)==null?void 0:s.replace(/\+/g," "))||"",i.value=((t=v.query.subcategory)==null?void 0:t.replace(/\+/g," "))||"",await C(),await m(1,o.value,i.value)}),L(()=>[v.query.category,v.query.subcategory],([s,t])=>{o.value=(s==null?void 0:s.replace(/\+/g," "))||"",i.value=(t==null?void 0:t.replace(/\+/g," "))||"",(o.value!==""||i.value!==""||o.value==="")&&m(1,o.value,i.value)}),(s,t)=>{const u=N("router-link");return c(),l("div",null,[a("div",D,[a("nav",M,[a("ol",F,[a("li",O,[w(u,{to:"/",class:"text-decoration-none"},{default:f(()=>t[2]||(t[2]=[_("首頁")])),_:1})]),t[3]||(t[3]=a("li",{class:"breadcrumb-item active"},"產品列表",-1))])]),a("div",z,[a("aside",E,[a("div",R,[(c(!0),l(g,null,b(x.value,e=>(c(),l("div",{key:e.id,class:"accordion-item border-0"},[a("h2",{class:"accordion-header",id:`productList${e.id}`},[a("button",{class:"accordion-button collapsed fw-bold border-0 shadow-none",type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapse${e.id}`,"aria-expanded":"false","aria-controls":`collapse${e.id}`},d(e.name),9,U)],8,T),a("div",{id:`collapse${e.id}`,class:"accordion-collapse collapse","aria-labelledby":`productList${e.id}`,"data-bs-parent":"#accordionProductsPage"},[a("div",G,[a("ul",H,[(c(!0),l(g,null,b(Object.values(e.subcategories),p=>(c(),l("li",{key:p.id,class:"nav-item"},[w(u,{to:{name:"shop-products",query:{category:e.name,subcategory:p.name}},class:"nav-link ps-3"},{default:f(()=>[_(d(p.name),1)]),_:2},1032,["to"])]))),128))])])],8,A)]))),128))])]),a("section",I,[a("div",J,[a("h4",K,d(o.value?o.value:"所有商品"),1),t[4]||(t[4]=V('<div class="col-2"><select class="form-select select-sort"><option selected>商品排序</option><option value="newest">上架時間: 由新到舊</option><option value="oldest">上架時間: 由舊到新</option><option value="highPrice">價格: 由高至低</option><option value="lowPrice">價格: 由低至高</option></select></div>',1))]),a("div",Q,[(c(!0),l(g,null,b($.value,e=>(c(),l("div",{class:"col",key:e.id},[_(d()+" ",1),a("div",W,[a("img",{src:e.imageUrl,class:"card-img-top",alt:"..."},null,8,X),a("div",Y,[a("p",Z,d(e.title),1),w(u,{to:`/shop/shop-product/${e.id}`,class:"btn btn-outline-secondary"},{default:f(()=>t[5]||(t[5]=[_("查看商品")])),_:2},1032,["to"])])])]))),128))]),a("nav",S,[a("ul",aa,[a("li",{class:k(["page-item mx-1",{disabled:n.value.currentPage===1}])},[a("button",{class:"page-link",onClick:t[0]||(t[0]=e=>y(n.value.currentPage-1))},t[6]||(t[6]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-left",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"})],-1)]))],2),(c(!0),l(g,null,b(h.value,e=>(c(),l("li",{key:e,class:k(["page-item mx-1",{active:e===n.value.currentPage}])},[a("button",{class:"page-link rounded-1",onClick:p=>y(e)},d(e),9,ea)],2))),128)),a("li",{class:k(["page-item mx-1",{disabled:n.value.currentPage===h.value}])},[a("button",{class:"page-link",onClick:t[1]||(t[1]=e=>y(n.value.currentPage+1))},t[7]||(t[7]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-right",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"})],-1)]))],2)])])])])])])}}};export{oa as default};
