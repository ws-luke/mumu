import{r as d,C as b,l as S,c as r,b as w,a as t,d as P,w as H,j as N,F as f,n as _,t as n,p as m,f as x,h as T,o as c,e as p,k as D,g as F}from"./index-Hf8QJDxd.js";import{_ as U}from"./ToastNotification-DqDQ2xBy.js";import{S as B}from"./sweetalert2.esm.all-DvhyLlFx.js";const q={class:"container-fluid"},E={class:"row mb-4"},O={class:"col"},Q={class:"d-flex align-items-center justify-content-between"},R={class:"breadcrumb mb-0"},G={class:"breadcrumb-item"},J={class:"row"},K={class:"col"},W={class:"card"},X={class:"p-4"},Y={class:"justify-content-between row"},Z={class:"col-lg-2 col-md-4 col-12"},tt=["value"],et={class:"card-body p-0"},st={class:"table table-borderless align-middle table-hover"},lt=["src"],at={class:"dropdown"},ot={class:"dropdown-menu dropdown-menu-end py-0"},nt={class:"p-2 list-unstyled mb-0"},it=["onClick"],rt=["onClick"],ct={class:"border-top d-md-flex justify-content-between align-items-center p-3"},dt={class:"pagination mb-0"},ut=["onClick"],bt={__name:"ProductsView",setup(vt){const y=d(null),M=F(),k=d([]),l=d({}),C=d([]),u=d(""),g=d(""),v=async(a=1,e=10,i="",s="")=>{try{const{data:o}=await x.get("undefined/products/all",{params:{page:a,limit:e,category:i,status:s}});o!=null&&o.data?(k.value=o.data.products||[],l.value=o.data.pagination||l.value):console.warn("無效的 API 回應結構",o)}catch(o){console.error("API 請求失敗:",o)}},V=a=>{M.push(`/admin/product/${a}`)},$=async(a,e)=>{try{if((await B.fire({title:"刪除產品",text:`確定要刪除${e}嗎`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#198754",cancelButtonColor:"#b6b6b6",confirmButtonText:"確定",cancelButtonText:"取消"})).isConfirmed){const o=(await x.delete(`undefined/products/product/${a}`)).data.message||"產品刪除成功！";y.value.showSuccessToast(o),await B.fire({title:"成功!",text:`刪除${e}成功`,icon:"success"}),await v(l.value.currentPage,l.value.limit,u.value,g.value)}}catch(i){console.error("API 請求失敗:",i)}},A=b(()=>Math.max((l.value.currentPage-1)*l.value.limit+1,0)),I=b(()=>Math.min(l.value.currentPage*l.value.limit,l.value.totalItems)),z=b(()=>Array.from({length:l.value.totalPages},(a,e)=>e+1)),h=async a=>{a<1||a>l.value.totalPages||a!==l.value.currentPage&&(l.value.currentPage=a,await v(a,l.value.limit,u.value,g.value))},L=async()=>{try{const{data:a}=await x.get("undefined/categories/all");C.value=Object.values(a.data)}catch(a){console.error("API 請求失敗:",a)}},j=async()=>{await v(1,l.value.limit,u.value,g.value)};return S(async()=>{try{await v(),await L()}catch(a){console.error(a.message)}}),(a,e)=>{const i=T("router-link");return c(),r("div",q,[w(U,{ref_key:"toast",ref:y},null,512),t("div",E,[t("div",O,[t("div",Q,[t("div",null,[e[5]||(e[5]=t("h2",null,"產品",-1)),t("nav",null,[t("ol",R,[t("li",G,[w(i,{to:"/admin/dashboard"},{default:P(()=>e[3]||(e[3]=[p("首頁")])),_:1})]),e[4]||(e[4]=t("li",{class:"breadcrumb-item active","aria-current":"page"},"產品",-1))])])]),w(i,{to:"/admin/product",class:"btn btn-primary"},{default:P(()=>e[6]||(e[6]=[p(" 新增產品 ")])),_:1})])])]),t("div",J,[t("div",K,[t("div",W,[t("div",X,[t("div",Y,[e[8]||(e[8]=t("div",{class:"mb-2 mb-lg-0 col-lg-4 col-md-6 col-12"},[t("form",{class:"d-flex"},[t("input",{placeholder:"搜尋產品",class:"form-control",type:"search"})])],-1)),t("div",Z,[H(t("select",{class:"form-select","onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),onChange:j},[e[7]||(e[7]=t("option",{value:""},"所有類別",-1)),(c(!0),r(f,null,_(C.value,s=>(c(),r("option",{key:s.id,value:s.name},n(s.name),9,tt))),128))],544),[[N,u.value]])])])]),t("div",et,[t("table",st,[e[13]||(e[13]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{colspan:"1"},[t("input",{class:"form-check-input",type:"checkbox"})]),t("th",{colspan:"1"},"圖片"),t("th",{colspan:"1"},"產品名稱"),t("th",{colspan:"1"},"類別"),t("th",{colspan:"1"},"狀態"),t("th",{colspan:"1"},"價格"),t("th",{colspan:"1"},"上架日期"),t("th",{colspan:"1"})])],-1)),t("tbody",null,[(c(!0),r(f,null,_(k.value,s=>(c(),r("tr",{key:s.id},[e[12]||(e[12]=t("td",{colspan:"1"},[t("input",{class:"form-check-input",type:"checkbox"})],-1)),t("td",null,[t("img",{class:"productImg",src:s.imageUrl,alt:""},null,8,lt)]),t("td",null,n(s.title),1),t("td",null,n(s.category),1),t("td",null,[t("span",{class:m(["badge",[s.is_enabled?"bg-success":"bg-secondary"]])},n(s.is_enabled?"已上架":"未上架"),3)]),t("td",null,n(s.price),1),t("td",null,n(s.createdAt),1),t("td",null,[t("div",at,[e[11]||(e[11]=D('<button class="text-reset btn p-0 border-0" data-bs-toggle="dropdown" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fs-5"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg></button>',1)),t("div",ot,[t("ul",nt,[t("li",null,[t("button",{type:"button",onClick:o=>V(s.id),class:"dropdown-item px-1 d-flex align-items-center btn"},e[9]||(e[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil-square me-2",viewBox:"0 0 16 16"},[t("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),t("path",{"fill-rule":"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"})],-1),p(" 編輯 ")]),8,it)]),t("li",null,[t("button",{type:"button",onClick:o=>$(s.id,s.title),class:"dropdown-item px-1 d-flex align-items-center btn"},e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash me-2",viewBox:"0 0 16 16"},[t("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),t("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1),p(" 刪除 ")]),8,rt)])])])])])]))),128))])])])])])]),t("div",ct,[t("div",null,"顯示 "+n(A.value)+" - "+n(I.value)+" 共 "+n(l.value.totalItems)+" 筆",1),t("nav",null,[t("ul",dt,[t("li",{class:m(["page-item",{disabled:l.value.currentPage===1}])},[t("button",{class:"page-link",onClick:e[1]||(e[1]=s=>h(l.value.currentPage-1))},e[14]||(e[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-left",viewBox:"0 0 16 16"},[t("path",{"fill-rule":"evenodd",d:"M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"})],-1)]))],2),(c(!0),r(f,null,_(z.value,s=>(c(),r("li",{key:s,class:m(["page-item",{active:s===l.value.currentPage}])},[t("button",{class:"page-link",onClick:o=>h(s)},n(s),9,ut)],2))),128)),t("li",{class:m(["page-item",{disabled:l.value.currentPage===l.value.totalPages}])},[t("button",{class:"page-link",onClick:e[2]||(e[2]=s=>h(l.value.currentPage+1))},e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-right",viewBox:"0 0 16 16"},[t("path",{"fill-rule":"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"})],-1)]))],2)])])])])}}};export{bt as default};
