import{r as p,m as O,h as f,c as n,a as g,b as s,t as y,d as V,w as a,v as i,F as _,p as k,j as S,I as E,J as $,i as W,s as B,g as D,o as d,f as C,u as F}from"./index-ehUiTKS-.js";import{_ as J}from"./ToastNotification-Ck8PgkN6.js";const L={class:"container-fluid"},z={class:"row mb-4"},A={class:"col d-flex justify-content-between align-items-center"},G={class:"breadcrumb mb-0"},H={class:"breadcrumb-item"},K={class:"breadcrumb-item active","aria-current":"page"},Q={class:"row"},X={class:"col-12 col-lg-8"},Y={class:"card mb-4"},Z={class:"card-body"},ss={class:"row"},os={class:"mb-3 col-lg-6"},ts={class:"mb-3 col-lg-6"},ls={class:"mb-3 col-lg-6"},es={class:"mb-3 col-lg-6"},as={class:"mb-3 col-lg-6"},rs={class:"card mb-4"},is={class:"card-body"},ns={class:"col-3"},ds=["for"],us=["id","onUpdate:modelValue"],cs={class:"col-3"},ms=["for"],ps=["id","onUpdate:modelValue"],bs={class:"col-3"},vs=["for"],fs=["id","onUpdate:modelValue"],gs={class:"col-3 d-flex align-items-end"},ys=["onClick"],_s={class:"card mb-4"},ks={class:"card-body"},ws={class:"row"},Us={class:"col-lg-3"},hs=["src"],Vs={class:"row"},Cs=["for"],Rs={class:"d-flex justify-content-between"},Ms=["onUpdate:modelValue","id"],Ss=["onClick"],$s=["src"],xs={class:"col-12 col-lg-4"},qs={class:"card mb-4"},Ps={class:"card-body"},Is={class:"mb-3 col"},js=["value"],Ts={class:"mb-3 col"},Ns=["disabled"],Os=["value"],Es={class:"card mb-4"},Ws={class:"card-body"},Bs={class:"form-check form-switch mb-3"},Ds=["checked"],Fs={class:"mb-3"},Js={class:"form-check form-check-inline"},Ls={class:"form-check form-check-inline"},zs={class:"card mb-4"},As={class:"card-body"},Gs={class:"mb-3"},Hs={class:"mb-3"},Ks={class:"mb-3"},oo={__name:"ProductView",setup(Qs){const R=F(),w=B().params.id||null,U=p(!!w),c=p([]),h=p([]),b=p([]),v=p(null),t=p({title:"",weight:"",material:"",warranty:"",retail_Price:"",origin_price:"",price:"",unit:"",is_enabled:"",is_stock:"",category:"",subcategory:"",imageUrl:"",imagesUrl:[""],productVariants:c}),x=async()=>{try{const{data:e}=await f.get("undefined/categories/all");h.value=Object.values(e.data)}catch(e){console.error("取得產品類別失敗:",e)}},M=async()=>{if(!t.value.category){b.value=[];return}const e=h.value.find(o=>o.name===t.value.category);e!=null&&e.subcategories?b.value=e.subcategories:b.value=[]},q=()=>{t.value.imagesUrl.push("")},P=e=>{t.value.imagesUrl.splice(e,1)},I=()=>{c.value.push({model:"",color:"",quantity:null})},j=e=>{c.value.splice(e,1)},T=async()=>{try{const o=(await f.post("undefined/products/product",t.value)).data.message||"產品新增成功！";v.value.showSuccessToast(o),t.value={},c.value=[],R.push("/admin/products")}catch(e){const o=e.message||"新增產品失敗";v.value.showErrorToast(o)}},N=async e=>{try{const m=(await f.put(`undefined/products/product/${e}`,t.value)).data.message||"產品編輯成功！";v.value.showSuccessToast(m),t.value={},c.value=[],R.push("/admin/products")}catch(o){const m=o.message||"編輯產品失敗";v.value.showErrorToast(m)}};return O(async()=>{if(await x(),U.value)try{const{data:e}=await f.get(`undefined/products/${w}`);t.value=e.data,c.value=e.data.productVariants,t.value.category&&M()}catch(e){console.error("無法載入產品資料",e)}}),(e,o)=>{const m=D("router-link");return d(),n("div",L,[g(J,{ref_key:"toast",ref:v},null,512),s("div",z,[s("div",A,[s("div",null,[s("h2",null,y(U.value?"編輯產品":"新增產品"),1),s("nav",null,[s("ol",G,[s("li",H,[g(m,{to:"/admin/dashboard"},{default:V(()=>o[15]||(o[15]=[C("首頁")])),_:1})]),s("li",K,[g(m,{to:"/admin/products"},{default:V(()=>o[16]||(o[16]=[C("產品")])),_:1})]),o[17]||(o[17]=s("li",{class:"breadcrumb-item active","aria-current":"page"}," 新增產品 ",-1))])])]),g(m,{to:"/admin/products",class:"btn btn-primary"},{default:V(()=>o[18]||(o[18]=[C("回訂單列表")])),_:1})])]),s("div",Q,[s("div",X,[s("div",Y,[s("div",Z,[o[24]||(o[24]=s("h4",{class:"h5 mb-4"},"產品資訊",-1)),s("div",ss,[s("div",os,[o[19]||(o[19]=s("label",{class:"form-label",for:"productName"},"產品名稱",-1)),a(s("input",{class:"form-control",id:"productName","onUpdate:modelValue":o[0]||(o[0]=l=>t.value.title=l),type:"text"},null,512),[[i,t.value.title]])]),s("div",ts,[o[20]||(o[20]=s("label",{class:"form-label",for:"productWeight"},"重量",-1)),a(s("input",{class:"form-control",type:"number",id:"productWeight","onUpdate:modelValue":o[1]||(o[1]=l=>t.value.weight=l)},null,512),[[i,t.value.weight]])]),s("div",ls,[o[21]||(o[21]=s("label",{class:"form-label",for:"productMaterial"},"材質",-1)),a(s("input",{class:"form-control",type:"text",id:"productMaterial","onUpdate:modelValue":o[2]||(o[2]=l=>t.value.material=l)},null,512),[[i,t.value.material]])]),s("div",es,[o[22]||(o[22]=s("label",{class:"form-label",for:"productWarranty"},"保固",-1)),a(s("input",{class:"form-control",type:"text",id:"productWarranty","onUpdate:modelValue":o[3]||(o[3]=l=>t.value.warranty=l)},null,512),[[i,t.value.warranty]])]),s("div",as,[o[23]||(o[23]=s("label",{class:"form-label",for:"productUnit"},"單位",-1)),a(s("input",{class:"form-control",type:"text",id:"productUnit","onUpdate:modelValue":o[4]||(o[4]=l=>t.value.unit=l)},null,512),[[i,t.value.unit]])])])])]),s("div",rs,[s("div",is,[s("div",{class:"col-12 d-flex align-items-center justify-content-between"},[o[25]||(o[25]=s("h4",{class:"mb-0 h5"},"顏色及數量",-1)),s("button",{onClick:I,type:"button",class:"btn btn-primary"},"新增")]),(d(!0),n(_,null,k(c.value,(l,r)=>(d(),n("div",{class:"row mt-3",key:r},[s("div",ns,[s("label",{class:"form-label",for:"form-model-"+r},"型號",8,ds),a(s("input",{type:"text",class:"form-control",id:"form-model-"+r,"onUpdate:modelValue":u=>l.model=u,required:""},null,8,us),[[i,l.model]])]),s("div",cs,[s("label",{class:"form-label",for:"form-color-"+r},"顏色",8,ms),a(s("input",{type:"text",class:"form-control",id:"form-color-"+r,"onUpdate:modelValue":u=>l.color=u,required:""},null,8,ps),[[i,l.color]])]),s("div",bs,[s("label",{class:"form-label",for:"form-quantity-"+r},"數量",8,vs),a(s("input",{type:"number",class:"form-control",id:"form-quantity-"+r,"onUpdate:modelValue":u=>l.quantity=u,required:""},null,8,fs),[[i,l.quantity]])]),s("div",gs,[s("button",{onClick:u=>j(r),type:"button",class:"btn btn-outline-danger w-100"}," 刪除 ",8,ys)])]))),128))])]),s("div",_s,[s("div",ks,[o[28]||(o[28]=s("h4",{class:"h5 mb-4"},"產品圖片",-1)),s("div",ws,[s("div",Us,[o[26]||(o[26]=s("label",{class:"form-label"},"產品主圖片",-1)),a(s("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=l=>t.value.imageUrl=l)},null,512),[[i,t.value.imageUrl]]),s("img",{class:"productImg img-fluid mb-3",src:t.value.imageUrl,alt:"",width:"250"},null,8,hs)])]),s("div",Vs,[s("div",{class:"d-flex align-items-center mb-3 justify-content-between"},[o[27]||(o[27]=s("p",{class:"mb-0 fs-5"},"產品其他圖片",-1)),s("button",{class:"btn btn-primary",onClick:q},"新增")]),(d(!0),n(_,null,k(t.value.imagesUrl,(l,r)=>(d(),n("div",{key:r,class:"col-lg-4"},[s("label",{class:"form-label",for:"form-image-"+r},"圖片"+y(r+1),9,Cs),s("div",Rs,[a(s("input",{type:"text",class:"form-control w-75","onUpdate:modelValue":u=>t.value.imagesUrl[r]=u,id:"form-image-"+r},null,8,Ms),[[i,t.value.imagesUrl[r]]]),s("button",{class:"btn btn-outline-danger",onClick:u=>P(r)},"刪除",8,Ss)]),s("img",{class:"productImg img-fluid my-3 w-100",src:t.value.imagesUrl[r],alt:""},null,8,$s)]))),128))])])])]),s("div",xs,[s("div",qs,[s("div",Ps,[o[33]||(o[33]=s("h4",{class:"mb-4 h5"},"產品類別",-1)),s("div",Is,[o[30]||(o[30]=s("label",{class:"form-label",for:"productCategory"},"產品類別",-1)),a(s("select",{class:"form-select",id:"productCategory","onUpdate:modelValue":o[6]||(o[6]=l=>t.value.category=l),onChange:M},[o[29]||(o[29]=s("option",{value:"",disabled:""},"請選擇產品類別",-1)),(d(!0),n(_,null,k(h.value,l=>(d(),n("option",{key:l.id,value:l.name},y(l.name),9,js))),128))],544),[[S,t.value.category]])]),s("div",Ts,[o[32]||(o[32]=s("label",{class:"form-label",for:"productSubcategory"},"子類別",-1)),a(s("select",{class:"form-select",id:"productSubcategory","onUpdate:modelValue":o[7]||(o[7]=l=>t.value.subcategory=l),disabled:b.value.length===0},[o[31]||(o[31]=s("option",{value:"",disabled:""},"請選擇子類別",-1)),(d(!0),n(_,null,k(b.value,l=>(d(),n("option",{key:l.id,value:l.name},y(l.name),9,Os))),128))],8,Ns),[[S,t.value.subcategory]])])])]),s("div",Es,[s("div",Ws,[s("div",Bs,[a(s("input",{id:"flexSwitchStock",class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=l=>t.value.is_stock=l),checked:t.value.is_stock},null,8,Ds),[[E,t.value.is_stock]]),o[34]||(o[34]=s("label",{for:"flexSwitchStock",class:"form-check-label"},"有庫存",-1))]),s("div",Fs,[o[37]||(o[37]=s("label",{class:"form-label"},"狀態",-1)),o[38]||(o[38]=s("br",null,null,-1)),s("div",Js,[a(s("input",{id:"inlineRadio1",class:"form-check-input",type:"radio","onUpdate:modelValue":o[9]||(o[9]=l=>t.value.is_enabled=l),value:1,name:"inlineRadioOptions"},null,512),[[$,t.value.is_enabled]]),o[35]||(o[35]=s("label",{title:"",for:"inlineRadio1",class:"form-check-label"},"上架",-1))]),s("div",Ls,[a(s("input",{id:"inlineRadio2",class:"form-check-input",type:"radio","onUpdate:modelValue":o[10]||(o[10]=l=>t.value.is_enabled=l),value:0,name:"inlineRadioOptions"},null,512),[[$,t.value.is_enabled]]),o[36]||(o[36]=s("label",{title:"",for:"inlineRadio2",class:"form-check-label"},"下架",-1))])])])]),s("div",zs,[s("div",As,[o[42]||(o[42]=s("h4",{class:"mb-4 h5"},"產品價格",-1)),s("div",Gs,[o[39]||(o[39]=s("label",{class:"form-label",for:"productRetail_price"},"終端售價",-1)),a(s("input",{class:"form-control",id:"productRetail_price",type:"number","onUpdate:modelValue":o[11]||(o[11]=l=>t.value.retail_Price=l)},null,512),[[i,t.value.retail_Price]])]),s("div",Hs,[o[40]||(o[40]=s("label",{class:"form-label",for:"productOrigin_price"},"最低終端售價",-1)),a(s("input",{class:"form-control",id:"productOrigin_price",type:"number","onUpdate:modelValue":o[12]||(o[12]=l=>t.value.origin_price=l)},null,512),[[i,t.value.origin_price]])]),s("div",Ks,[o[41]||(o[41]=s("label",{class:"form-label",for:"productPrice"},"批發價",-1)),a(s("input",{class:"form-control",id:"productPrice",type:"number","onUpdate:modelValue":o[13]||(o[13]=l=>t.value.price=l)},null,512),[[i,t.value.price]])])])]),U.value?(d(),n("button",{key:0,type:"button",class:"btn btn-success w-100",onClick:o[14]||(o[14]=l=>N(W(w)))},"編輯產品")):(d(),n("button",{key:1,type:"button",class:"btn btn-success w-100",onClick:T},"新增產品"))])])])}}};export{oo as default};
