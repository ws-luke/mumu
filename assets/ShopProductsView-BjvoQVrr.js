import{_ as N,r as i,m as B,n as j,c as o,b as a,a as w,d as f,F as g,p as _,t as r,l as D,q as y,s as I,h as L,g as M,o as l,f as C,x as F}from"./index-z-dTSlmB.js";const O={class:"container-fluid mt-4"},T={"aria-label":"breadcrumb",class:"mb-4"},z={class:"breadcrumb"},E={class:"breadcrumb-item"},R={class:"row"},U={class:"mb-6 mb-md-0 col-lg-3 col-md-4 d-none d-lg-block"},A={class:"accordion",id:"accordionProductsPage"},G=["id"],H=["data-bs-target","aria-controls"],J=["id","aria-labelledby"],K={class:"accordion-body p-0"},Q={class:"navbar-nav px-3"},S={class:"col-lg-9 col-md-12"},W={class:"row justify-content-between mb-4"},X={class:"col"},Y={class:"row row-cols-2 row-cols-lg-3 row-cols-xl-4 g-3 mb-4"},Z={key:0,class:"card-img-top bg-light placeholder-glow h-100"},aa=["src","alt","onLoad"],ea={class:"card-body"},ta={class:"card-title text-center"},sa={class:"text-center price mb-0 fw-bold"},oa={"aria-label":"Page navigation example"},la={class:"pagination justify-content-center"},ca=["onClick"],na={__name:"ShopProductsView",setup(ia){const p=I(),c=i(""),d=i(""),x=i([]),k=void 0,P=i([]),n=i({}),b=i(0),$=i({}),h=async(s,t,u)=>{try{const e=await L.get(`${k}/products/all`,{params:{page:s,category:t,subcategory:u}});P.value=e.data.data.products||[],n.value=e.data.data.pagination,b.value=n.value.totalPages}catch(e){console.error("取得商品資料失敗:",e)}},V=async()=>{try{const{data:s}=await L.get(`${k}/categories/all`);x.value=Object.values(s.data)}catch(s){console.error("取得分類資料失敗:",s)}},m=async s=>{await h(s,c.value,d.value)},q=s=>{$.value[s]=!0};return B(async()=>{var s,t;c.value=((s=p.query.category)==null?void 0:s.replace(/\+/g," "))||"",d.value=((t=p.query.subcategory)==null?void 0:t.replace(/\+/g," "))||"",await V(),await h(1,c.value,d.value)}),j(()=>[p.query.category,p.query.subcategory],([s,t])=>{c.value=(s==null?void 0:s.replace(/\+/g," "))||"",d.value=(t==null?void 0:t.replace(/\+/g," "))||"",(c.value!==""||d.value!==""||c.value==="")&&h(1,c.value,d.value)}),(s,t)=>{const u=M("router-link");return l(),o("div",null,[a("div",O,[a("nav",T,[a("ol",z,[a("li",E,[w(u,{to:"/",class:"text-decoration-none"},{default:f(()=>t[2]||(t[2]=[C("首頁")])),_:1})]),t[3]||(t[3]=a("li",{class:"breadcrumb-item active"},"產品列表",-1))])]),a("div",R,[a("aside",U,[a("div",A,[(l(!0),o(g,null,_(x.value,e=>(l(),o("div",{key:e.id,class:"accordion-item border-0"},[a("h2",{class:"accordion-header",id:`productList${e.id}`},[a("button",{class:"accordion-button collapsed fw-bold border-0 shadow-none",type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapse${e.id}`,"aria-expanded":"false","aria-controls":`collapse${e.id}`},r(e.name),9,H)],8,G),a("div",{id:`collapse${e.id}`,class:"accordion-collapse collapse","aria-labelledby":`productList${e.id}`,"data-bs-parent":"#accordionProductsPage"},[a("div",K,[a("ul",Q,[(l(!0),o(g,null,_(Object.values(e.subcategories),v=>(l(),o("li",{key:v.id,class:"nav-item"},[w(u,{to:{name:"shop-products",query:{category:e.name,subcategory:v.name}},class:"nav-link ps-3"},{default:f(()=>[C(r(v.name),1)]),_:2},1032,["to"])]))),128))])])],8,J)]))),128))])]),a("section",S,[a("div",W,[a("h4",X,r(c.value?c.value:"所有商品"),1),t[4]||(t[4]=D('<div class="col-2" data-v-c4d42a71><select class="form-select select-sort" data-v-c4d42a71><option selected data-v-c4d42a71>商品排序</option><option value="newest" data-v-c4d42a71>上架時間: 由新到舊</option><option value="oldest" data-v-c4d42a71>上架時間: 由舊到新</option><option value="highPrice" data-v-c4d42a71>價格: 由高至低</option><option value="lowPrice" data-v-c4d42a71>價格: 由低至高</option></select></div>',1))]),a("div",Y,[(l(!0),o(g,null,_(P.value,e=>(l(),o("div",{class:"col",key:e.id},[w(u,{class:"card h-100 text-decoration-none",to:`/shop/shop-product/${e.id}`},{default:f(()=>[$.value[e.id]?F("",!0):(l(),o("div",Z,t[5]||(t[5]=[a("span",{class:"placeholder w-100 h-100"},null,-1)]))),a("img",{src:e.imageUrl,class:"card-img-top img-fluid",alt:e.title,onLoad:v=>q(e.id)},null,40,aa),a("div",ea,[a("p",ta,r(e.title),1),a("p",sa," NT$ "+r(e.price),1)])]),_:2},1032,["to"])]))),128))]),a("nav",oa,[a("ul",la,[a("li",{class:y(["page-item mx-1",{disabled:n.value.currentPage===1}])},[a("button",{class:"page-link",onClick:t[0]||(t[0]=e=>m(n.value.currentPage-1))},t[6]||(t[6]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-left",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"})],-1)]))],2),(l(!0),o(g,null,_(b.value,e=>(l(),o("li",{key:e,class:y(["page-item mx-1",{active:e===n.value.currentPage}])},[a("button",{class:"page-link rounded-1",onClick:v=>m(e)},r(e),9,ca)],2))),128)),a("li",{class:y(["page-item mx-1",{disabled:n.value.currentPage===b.value}])},[a("button",{class:"page-link",onClick:t[1]||(t[1]=e=>m(n.value.currentPage+1))},t[7]||(t[7]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-right",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"})],-1)]))],2)])])])])])])}}},ra=N(na,[["__scopeId","data-v-c4d42a71"]]);export{ra as default};
