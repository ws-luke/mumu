import{r as n,c as i,d as _,a as s,F as d,b as p,w as h,v as y,h as w,o as u}from"./index-DbV5Pvur.js";import{_ as g}from"./ToastNotification-BQqKk-NZ.js";const T={class:"row mb-3"},k={class:"col"},x={class:"col"},C=["disabled"],F={class:"row"},V={class:"col-8"},L={__name:"uploadView",setup(E){const v="https://mumuapi.zeabur.app/api",t=n(null),c=n(null),o=n(""),l=n(!1),m=e=>{c.value=e.target.files[0]},f=async()=>{try{l.value=!0;const e=new FormData;e.append("file",c.value);const a=await w.post(`${v}/files/upload`,e,{headers:{"Content-Type":"multipart/form-data"}}),r=a.data.message||"檔案上傳成功";o.value=a.data.imageURL,t.value.showSuccessToast(r)}catch(e){t.value.showErrorToast(e.response.data.message||"檔案上傳失敗")}finally{l.value=!1}},b=()=>{if(!o.value){t.value.showErrorToast("無可複製的網址！");return}navigator.clipboard.writeText(o.value).then(()=>{t.value.showSuccessToast("網址已成功複製！")}).catch(()=>{t.value.showErrorToast("複製失敗，請手動複製！")})};return(e,a)=>(u(),i("div",null,[_(g,{ref_key:"toast",ref:t},null,512),s("div",T,[s("div",k,[s("input",{class:"form-control",type:"file",name:"file",required:"",onChange:m},null,32)]),s("div",x,[s("button",{onClick:f,type:"button",class:"btn btn-primary",disabled:l.value},[l.value?(u(),i(d,{key:0},[a[1]||(a[1]=s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),a[2]||(a[2]=p(" 上傳中... "))],64)):(u(),i(d,{key:1},[p(" 上傳 ")],64))],8,C)])]),s("div",F,[s("div",V,[a[3]||(a[3]=s("label",{class:"form-label"},"圖片網址:",-1)),h(s("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=r=>o.value=r)},null,512),[[y,o.value]]),s("button",{onClick:b,class:"btn btn-secondary mt-2"},"複製網址")])])]))}};export{L as default};
